<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Valuation DCF - AnÃ¡lise Fundamentalista</title>
    <meta name="description" content="Calculadora profissional de Valuation por Fluxo de Caixa Descontado (DCF) com extraÃ§Ã£o automÃ¡tica de PDFs CVM">
    
    <!-- Tailwind CSS compilado - SEM avisos -->
    <link href="https://unpkg.com/tailwindcss@3.4.0/dist/tailwind.min.css" rel="stylesheet">
    
    <!-- React - ProduÃ§Ã£o -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <style>
        body { 
            margin: 0; 
            padding: 0; 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
        }
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }
        .btn-secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            transition: all 0.3s ease;
        }
        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(245, 87, 108, 0.3);
        }
        .resultado-destaque {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .8; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script>
        const { useState, createElement: h } = React;

        // Componente principal
        function ValuationCalculator() {
            // Estados principais
            const [ebit, setEbit] = useState(1457.6);
            const [lucroLiq, setLucroLiq] = useState(1222.4);
            const [depre, setDepre] = useState(167.6);
            const [capex, setCapex] = useState(344.6);
            const [ncgVar, setNcgVar] = useState(685.1);
            const [numAcoes, setNumAcoes] = useState(1127594551);
            const [fluxoDivida, setFluxoDivida] = useState(306.9);
            const [pdfStatus, setPdfStatus] = useState(null);
            
            // ParÃ¢metros de projeÃ§Ã£o
            const [taxaDI, setTaxaDI] = useState(13.5);
            const [premioRisco, setPremioRisco] = useState(2.0);
            const [taxaCrescPerp, setTaxaCrescPerp] = useState(3.0);
            const [anoBase, setAnoBase] = useState(2024);
            
            const [taxaCresc2025, setTaxaCresc2025] = useState(5.0);
            const [taxaCresc2026, setTaxaCresc2026] = useState(4.0);
            const [taxaCresc2027, setTaxaCresc2027] = useState(3.5);

            const [roicAtual, setRoicAtual] = useState(15.0);
            const [custoCapital, setCustoCapital] = useState(12.0);

            const [calculado, setCalculado] = useState(false);
            const [mostrarConfig, setMostrarConfig] = useState(false);

            // FunÃ§Ã£o para calcular
            const calcular = () => {
                setCalculado(true);
                window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
            };

            // FunÃ§Ã£o para limpar
            const limpar = () => {
                if (confirm('Deseja realmente limpar todos os dados?')) {
                    setEbit(0);
                    setLucroLiq(0);
                    setDepre(0);
                    setCapex(0);
                    setNcgVar(0);
                    setNumAcoes(0);
                    setFluxoDivida(0);
                    setTaxaDI(13.5);
                    setPremioRisco(2.0);
                    setTaxaCrescPerp(3.0);
                    setTaxaCresc2025(5.0);
                    setTaxaCresc2026(4.0);
                    setTaxaCresc2027(3.5);
                    setRoicAtual(15.0);
                    setCustoCapital(12.0);
                    setCalculado(false);
                    setPdfStatus(null);
                }
            };

            // FunÃ§Ã£o para usar dados de exemplo
            const usarExemplo = () => {
                setEbit(1457.6);
                setLucroLiq(1222.4);
                setDepre(167.6);
                setCapex(344.6);
                setNcgVar(685.1);
                setNumAcoes(1127594551);
                setFluxoDivida(306.9);
                setPdfStatus({ type: 'success', message: 'Dados de exemplo carregados (Marcopolo S.A.)' });
            };

            // ExtraÃ§Ã£o de PDF
            const extrairDadosPDF = async (file) => {
                setPdfStatus({ type: 'loading', message: 'Processando PDF...' });
                
                try {
                    const arrayBuffer = await file.arrayBuffer();
                    const uint8Array = new Uint8Array(arrayBuffer);
                    const decoder = new TextDecoder('utf-8');
                    let texto = '';
                    
                    try {
                        texto = decoder.decode(uint8Array);
                    } catch (e) {
                        const decoderLatin = new TextDecoder('latin1');
                        texto = decoderLatin.decode(uint8Array);
                    }

                    const padroes = {
                        ebit: [
                            /resultado\s+antes\s+(?:do\s+)?(?:resultado\s+)?financeiro.*?[\s\(]+([\d.,]+)/gi,
                            /lucro\s+operacional.*?[\s\(]+([\d.,]+)/gi,
                            /(?:3\.05|305).*?[\s\(]+([\d.,]+)/gi,
                            /EBIT.*?[\s\(]+([\d.,]+)/gi,
                        ],
                        lucroLiquido: [
                            /lucro\s+(?:lÃ­quido|liquido)(?:\s+do\s+perÃ­odo)?.*?[\s\(]+([\d.,]+)/gi,
                            /(?:3\.11|311).*?[\s\(]+([\d.,]+)/gi,
                        ],
                        depreciacao: [
                            /depreciaÃ§Ã£o.*?[\s\(]+([\d.,]+)/gi,
                            /amortizaÃ§Ã£o.*?[\s\(]+([\d.,]+)/gi,
                        ],
                        capex: [
                            /(?:aquisiÃ§Ã£o|aquis).*?(?:imobilizado|ativo).*?[\s\(]+([\d.,]+)/gi,
                            /CAPEX.*?[\s\(]+([\d.,]+)/gi,
                        ],
                        numeroAcoes: [
                            /(?:quantidade|nÃºmero).*?aÃ§Ãµes.*?[\s\(]+([\d.,]+)/gi,
                            /aÃ§Ãµes.*?em.*?circulaÃ§Ã£o.*?[\s\(]+([\d.,]+)/gi,
                        ],
                    };

                    const dados = {};
                    let encontrados = 0;

                    for (const [campo, regexList] of Object.entries(padroes)) {
                        for (const regex of regexList) {
                            const matches = [...texto.matchAll(regex)];
                            if (matches.length > 0) {
                                const valores = matches
                                    .map(m => {
                                        const val = m[1].replace(/\./g, '').replace(',', '.');
                                        return parseFloat(val);
                                    })
                                    .filter(v => !isNaN(v) && v > 0);
                                
                                if (valores.length > 0) {
                                    dados[campo] = Math.max(...valores);
                                    encontrados++;
                                    break;
                                }
                            }
                        }
                    }

                    if (encontrados > 0) {
                        if (dados.ebit) setEbit(dados.ebit);
                        if (dados.lucroLiquido) setLucroLiq(dados.lucroLiquido);
                        if (dados.depreciacao) setDepre(dados.depreciacao);
                        if (dados.capex) setCapex(dados.capex);
                        if (dados.numeroAcoes) setNumAcoes(dados.numeroAcoes);
                        
                        setPdfStatus({ 
                            type: 'success', 
                            message: `âœ“ ${encontrados} valores extraÃ­dos com sucesso!`,
                            data: dados
                        });
                    } else {
                        setPdfStatus({ 
                            type: 'warning', 
                            message: 'âš ï¸ PDF processado, mas valores nÃ£o identificados. Preencha manualmente.' 
                        });
                    }
                    
                } catch (error) {
                    setPdfStatus({ 
                        type: 'error', 
                        message: 'âŒ Erro ao processar PDF. Verifique o arquivo.' 
                    });
                }
            };

            const handleFileUpload = (event) => {
                const file = event.target.files[0];
                if (file && file.type === 'application/pdf') {
                    extrairDadosPDF(file);
                }
            };

            // CÃ¡lculos
            const nopat = ebit * 0.66;
            const investLiq = capex - depre;
            const fcff = nopat + depre - capex - ncgVar;
            const fcfe = lucroLiq + depre - capex - ncgVar + fluxoDivida;
            const reinvestimentoTotal = investLiq + ncgVar;
            const sobraNopat = nopat - reinvestimentoTotal;
            const taxaRr = reinvestimentoTotal / nopat;

            const wacc = taxaDI + premioRisco;

            const fcfe2025 = fcfe * (1 + taxaCresc2025 / 100);
            const fcfe2026 = fcfe2025 * (1 + taxaCresc2026 / 100);
            const fcfe2027 = fcfe2026 * (1 + taxaCresc2027 / 100);

            const roic2025 = roicAtual > custoCapital ? roicAtual - (roicAtual - custoCapital) * 0.2 : roicAtual;
            const roic2026 = roic2025 > custoCapital ? roic2025 - (roic2025 - custoCapital) * 0.2 : roic2025;
            const roic2027 = roic2026 > custoCapital ? roic2026 - (roic2026 - custoCapital) * 0.2 : roic2026;

            const vp2025 = fcfe2025 / Math.pow(1 + wacc / 100, 1);
            const vp2026 = fcfe2026 / Math.pow(1 + wacc / 100, 2);
            const vp2027 = fcfe2027 / Math.pow(1 + wacc / 100, 3);

            const fluxoPerpetuidade = fcfe2027 * (1 + taxaCrescPerp / 100);
            const valorPerpetuidade = fluxoPerpetuidade / ((wacc - taxaCrescPerp) / 100);
            const vpPerpetuidade = valorPerpetuidade / Math.pow(1 + wacc / 100, 3);

            const valorTotalFirma = vp2025 + vp2026 + vp2027 + vpPerpetuidade;
            const precoJustoPorAcao = (valorTotalFirma * 1000000) / numAcoes;

            const fmt = (val) => val.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2});

            return h('div', { className: 'min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4' },
                h('div', { className: 'max-w-7xl mx-auto' },
                    
                    // Header
                    h('div', { className: 'bg-white rounded-lg shadow-lg p-6 mb-6' },
                        h('h1', { className: 'text-3xl font-bold text-gray-800 mb-2' }, 
                            'ðŸ“Š Calculadora de Valuation DCF'
                        ),
                        h('p', { className: 'text-gray-600' }, 
                            'AnÃ¡lise fundamentalista completa com projeÃ§Ãµes e perpetuidade'
                        )
                    ),

                    // Upload de PDF
                    h('div', { className: 'bg-white rounded-lg shadow-lg p-6 mb-6' },
                        h('h2', { className: 'text-xl font-semibold mb-4' }, 
                            'ðŸ“ Upload de ITR/DFP (CVM) - Ano Base: ' + anoBase
                        ),
                        
                        h('div', { className: 'grid grid-cols-1 md:grid-cols-3 gap-4 mb-4' },
                            h('div', { className: 'border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-indigo-400 transition-colors' },
                                h('label', { className: 'cursor-pointer block' },
                                    h('div', { className: 'text-4xl mb-3' }, 'ðŸ“„'),
                                    h('span', { className: 'bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 inline-block text-sm font-medium' }, 
                                        'Selecionar PDF'
                                    ),
                                    h('input', { 
                                        type: 'file',
                                        accept: '.pdf',
                                        onChange: handleFileUpload,
                                        className: 'hidden'
                                    }),
                                    h('p', { className: 'text-xs text-gray-500 mt-2' }, 
                                        'ITR ou DFP da CVM'
                                    )
                                )
                            ),
                            
                            h('div', null,
                                h('label', { className: 'block text-sm font-medium text-gray-700 mb-2' }, 
                                    'Ano Base'
                                ),
                                h('input', { 
                                    type: 'number',
                                    value: anoBase,
                                    onChange: (e) => setAnoBase(parseInt(e.target.value) || 2024),
                                    className: 'w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500'
                                })
                            ),

                            h('div', { className: 'flex items-end' },
                                h('button', { 
                                    onClick: usarExemplo,
                                    className: 'w-full bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-3 px-4 rounded-lg transition-colors text-sm'
                                }, 'ðŸŽ¯ Usar Dados de Exemplo')
                            )
                        ),

                        pdfStatus && h('div', { 
                            className: `mt-4 p-4 rounded-lg ${
                                pdfStatus.type === 'success' ? 'bg-green-50 border border-green-200 text-green-800' :
                                pdfStatus.type === 'error' ? 'bg-red-50 border border-red-200 text-red-800' :
                                pdfStatus.type === 'warning' ? 'bg-yellow-50 border border-yellow-200 text-yellow-800' :
                                'bg-blue-50 border border-blue-200 text-blue-800'
                            }`
                        },
                            h('p', { className: 'font-medium text-sm' }, pdfStatus.message),
                            pdfStatus.data && h('div', { className: 'mt-2 text-xs space-y-1' },
                                pdfStatus.data.ebit && h('p', null, 'âœ“ EBIT: R$ ' + fmt(pdfStatus.data.ebit) + ' Mi'),
                                pdfStatus.data.lucroLiquido && h('p', null, 'âœ“ Lucro LÃ­quido: R$ ' + fmt(pdfStatus.data.lucroLiquido) + ' Mi'),
                                pdfStatus.data.numeroAcoes && h('p', null, 'âœ“ AÃ§Ãµes: ' + pdfStatus.data.numeroAcoes.toLocaleString('pt-BR'))
                            )
                        )
                    ),

                    // Dados Financeiros
                    h('div', { className: 'bg-white rounded-lg shadow-lg p-6 mb-6' },
                        h('h2', { className: 'text-xl font-semibold mb-4' }, 
                            'ðŸ’° Dados Financeiros (R$ MilhÃµes)'
                        ),
                        h('div', { className: 'grid grid-cols-1 md:grid-cols-3 gap-4' },
                            ['EBIT (3.05)', ebit, setEbit],
                            ['Lucro LÃ­quido (3.11)', lucroLiq, setLucroLiq],
                            ['DepreciaÃ§Ã£o/AmortizaÃ§Ã£o', depre, setDepre],
                            ['CAPEX Bruto', capex, setCapex],
                            ['VariaÃ§Ã£o da NCG', ncgVar, setNcgVar],
                            ['Total de AÃ§Ãµes', numAcoes, setNumAcoes],
                            ['Fluxo LÃ­quido DÃ­vida', fluxoDivida, setFluxoDivida]
                        ].map(([label, val, setter], i) => 
                            h('div', { key: i },
                                h('label', { className: 'block text-sm font-medium text-gray-700 mb-2' }, label),
                                h('input', { 
                                    type: 'number',
                                    step: '0.1',
                                    value: val,
                                    onChange: (e) => setter(parseFloat(e.target.value) || 0),
                                    className: 'w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500'
                                })
                            )
                        )
                    ),

                    // ConfiguraÃ§Ãµes AvanÃ§adas (ColapsÃ¡vel)
                    h('div', { className: 'bg-white rounded-lg shadow-lg p-6 mb-6' },
                        h('button', { 
                            onClick: () => setMostrarConfig(!mostrarConfig),
                            className: 'w-full text-left text-xl font-semibold flex items-center justify-between hover:text-indigo-600 transition-colors'
                        },
                            h('span', null, 'âš™ï¸ ParÃ¢metros de ProjeÃ§Ã£o e Desconto'),
                            h('span', { className: 'text-2xl' }, mostrarConfig ? 'â–¼' : 'â–¶')
                        ),

                        mostrarConfig && h('div', { className: 'mt-6 space-y-6' },
                            h('div', { className: 'grid grid-cols-1 md:grid-cols-3 gap-4' },
                                [
                                    ['Taxa DI Futura (%)', taxaDI, setTaxaDI, 'Expectativa: ~13,5%'],
                                    ['PrÃªmio de Risco (%)', premioRisco, setPremioRisco, 'SugestÃ£o: 2% a 6%'],
                                    ['Taxa Crescimento PerpÃ©tuo (%)', taxaCrescPerp, setTaxaCrescPerp, 'PIB longo prazo']
                                ].map(([label, val, setter, hint], i) => 
                                    h('div', { key: i },
                                        h('label', { className: 'block text-sm font-medium text-gray-700 mb-2' }, label),
                                        h('input', { 
                                            type: 'number',
                                            step: '0.1',
                                            value: val,
                                            onChange: (e) => setter(parseFloat(e.target.value) || 0),
                                            className: 'w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500'
                                        }),
                                        h('p', { className: 'text-xs text-gray-500 mt-1' }, hint)
                                    )
                                )
                            ),

                            h('div', { className: 'bg-purple-50 p-4 rounded-lg' },
                                h('p', { className: 'text-sm font-medium text-purple-900' }, 
                                    'WACC: ' + wacc.toFixed(2) + '% (DI + PrÃªmio)'
                                )
                            ),

                            h('h3', { className: 'font-semibold text-gray-800 mt-6' }, 
                                'Taxas de Crescimento Anual'
                            ),
                            h('div', { className: 'grid grid-cols-1 md:grid-cols-3 gap-4' },
                                [
                                    [(anoBase + 1) + ' (%)', taxaCresc2025, setTaxaCresc2025],
                                    [(anoBase + 2) + ' (%)', taxaCresc2026, setTaxaCresc2026],
                                    [(anoBase + 3) + ' (%)', taxaCresc2027, setTaxaCresc2027]
                                ].map(([label, val, setter], i) => 
                                    h('div', { key: i },
                                        h('label', { className: 'block text-sm font-medium text-gray-700 mb-2' }, label),
                                        h('input', { 
                                            type: 'number',
                                            step: '0.1',
                                            value: val,
                                            onChange: (e) => setter(parseFloat(e.target.value) || 0),
                                            className: 'w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500'
                                        })
                                    )
                                )
                            ),

                            h('h3', { className: 'font-semibold text-gray-800 mt-6' }, 
                                'ROIC e Sustentabilidade'
                            ),
                            h('div', { className: 'grid grid-cols-1 md:grid-cols-2 gap-4' },
                                [
                                    ['ROIC Atual (%)', roicAtual, setRoicAtual],
                                    ['Custo de Capital (%)', custoCapital, setCustoCapital]
                                ].map(([label, val, setter], i) => 
                                    h('div', { key: i },
                                        h('label', { className: 'block text-sm font-medium text-gray-700 mb-2' }, label),
                                        h('input', { 
                                            type: 'number',
                                            step: '0.1',
                                            value: val,
                                            onChange: (e) => setter(parseFloat(e.target.value) || 0),
                                            className: 'w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500'
                                        })
                                    )
                                )
                            )
                        )
                    ),

                    // BotÃµes de AÃ§Ã£o
                    h('div', { className: 'grid grid-cols-1 md:grid-cols-2 gap-4 mb-6' },
                        h('button', { 
                            onClick: calcular,
                            className: 'btn-primary text-white font-bold py-4 px-8 rounded-lg shadow-lg text-lg'
                        }, 'ðŸš€ CALCULAR VALUATION'),
                        
                        h('button', { 
                            onClick: limpar,
                            className: 'btn-secondary text-white font-bold py-4 px-8 rounded-lg shadow-lg text-lg'
                        }, 'ðŸ—‘ï¸ LIMPAR DADOS')
                    ),

                    // Resultado Principal
                    calculado && h('div', { className: 'bg-gradient-to-r from-emerald-500 to-green-600 rounded-lg shadow-2xl p-8 text-white mb-6 resultado-destaque' },
                        h('div', { className: 'text-center' },
                            h('h2', { className: 'text-2xl font-bold mb-2' }, 
                                'ðŸ’Ž PreÃ§o Justo por AÃ§Ã£o (DCF)'
                            ),
                            h('div', { className: 'text-7xl font-bold my-6' }, 
                                'R$ ' + fmt(precoJustoPorAcao)
                            ),
                            h('p', { className: 'text-green-100 text-lg mb-6' }, 
                                'Baseado em Fluxo de Caixa Descontado com perpetuidade'
                            ),
                            h('div', { className: 'grid grid-cols-1 md:grid-cols-3 gap-4 mt-6' },
                                [
                                    ['Valor da Firma', 'R$ ' + fmt(valorTotalFirma) + ' Mi'],
                                    ['WACC', wacc.toFixed(2) + '%'],
                                    ['FCFE ' + anoBase, 'R$ ' + fmt(fcfe) + ' Mi']
                                ].map(([label, val], i) => 
                                    h('div', { key: i, className: 'bg-white bg-opacity-20 p-4 rounded-lg' },
                                        h('div', { className: 'text-sm text-green-100' }, label),
                                        h('div', { className: 'text-xl font-bold' }, val)
                                    )
                                )
                            )
                        )
                    ),

                    // Tabela de ProjeÃ§Ãµes
                    calculado && h('div', { className: 'bg-white rounded-lg shadow-lg p-6 mb-6' },
                        h('h2', { className: 'text-xl font-semibold mb-4' }, 
                            'ðŸ“ˆ ProjeÃ§Ãµes de Fluxo de Caixa (FCFE)'
                        ),
                        h('div', { className: 'overflow-x-auto' },
                            h('table', { className: 'w-full text-sm border-collapse' },
                                h('thead', { className: 'bg-gray-100' },
                                    h('tr', null,
                                        ['Ano', 'FCFE (R$ Mi)', 'Crescimento', 'ROIC', 'Valor Presente'].map(th => 
                                            h('th', { className: 'p-3 text-left font-semibold border-b-2' }, th)
                                        )
                                    )
                                ),
                                h('tbody', null,
                                    [
                                        [anoBase + ' (Base)', fcfe, '-', roicAtual, '-', 'bg-white'],
                                        [anoBase + 1, fcfe2025, taxaCresc2025, roic2025, vp2025, 'bg-green-50'],
                                        [anoBase + 2, fcfe2026, taxaCresc2026, roic2026, vp2026, 'bg-green-50'],
                                        [anoBase + 3, fcfe2027, taxaCresc2027, roic2027, vp2027, 'bg-green-50'],
                                        ['Perpetuidade', fluxoPerpetuidade, taxaCrescPerp, '-', vpPerpetuidade, 'bg-purple-50']
                                    ].map(([ano, fcfeVal, cresc, roicVal, vp, bg], i) => 
                                        h('tr', { key: i, className: bg + ' border-b' },
                                            h('td', { className: 'p-3 font-medium' }, ano),
                                            h('td', { className: 'p-3 text-right' }, typeof fcfeVal === 'number' ? fmt(fcfeVal) : fcfeVal),
                                            h('td', { className: 'p-3 text-right' }, typeof cresc === 'number' ? cresc.toFixed(2) + '%' : cresc),
                                            h('td', { className: 'p-3 text-right' }, typeof roicVal === 'number' ? roicVal.toFixed(2) + '%' : roicVal),
                                            h('td', { className: 'p-3 text-right font-semibold' }, typeof vp === 'number' ? fmt(vp) : vp)
                                        )
                                    ),
                                    h('tr', { className: 'bg-gray-100 font-bold' },
                                        h('td', { colSpan: 4, className: 'p-3 text-right' }, 'Valor Total:'),
                                        h('td', { className: 'p-3 text-right text-lg text-indigo-700' }, fmt(valorTotalFirma))
                                    )
                                )
                            )
                        )
                    ),

                    // AnÃ¡lise de Sustentabilidade
                    calculado && h('div', { className: 'bg-white rounded-lg shadow-lg p-6 mb-6' },
                        h('h2', { className: 'text-xl font-semibold mb-4' }, 
                            'ðŸŽ¯ AnÃ¡lise de Sustentabilidade'
                        ),
                        h('div', { className: 'grid grid-cols-1 md:grid-cols-2 gap-6' },
                            h('div', { className: 'bg-blue-50 p-4 rounded-lg' },
                                h('h3', { className: 'font-semibold mb-3 text-blue-900' }, 
                                    'ConvergÃªncia de ROIC'
                                ),
                                h('div', { className: 'space-y-2 text-sm' },
                                    [
                                        ['ROIC ' + anoBase, roicAtual],
                                        ['ROIC ' + (anoBase + 1), roic2025],
                                        ['ROIC ' + (anoBase + 2), roic2026],
                                        ['ROIC ' + (anoBase + 3), roic2027]
                                    ].map(([label, val], i) => 
                                        h('div', { key: i, className: 'flex justify-between' },
                                            h('span', null, label + ':'),
                                            h('span', { className: 'font-bold' }, val.toFixed(2) + '%')
                                        )
                                    ),
                                    h('div', { className: 'flex justify-between border-t pt-2 mt-2' },
                                        h('span', null, 'Custo Capital:'),
                                        h('span', { className: 'font-bold text-blue-700' }, custoCapital.toFixed(2) + '%')
                                    )
                                )
                            ),

                            h('div', { className: 'bg-green-50 p-4 rounded-lg' },
                                h('h3', { className: 'font-semibold mb-3 text-green-900' }, 
                                    'MÃ©tricas de Qualidade'
                                ),
                                h('div', { className: 'space-y-2 text-sm' },
                                    [
                                        ['Taxa Reinvestimento', (taxaRr * 100).toFixed(2) + '%'],
                                        ['NOPAT', 'R$ ' + fmt(nopat) + ' Mi'],
                                        ['Sobra do NOPAT', 'R$ ' + fmt(sobraNopat) + ' Mi'],
                                        ['FCFF (Firma)', 'R$ ' + fmt(fcff) + ' Mi'],
                                        ['FCFE (Acionista)', 'R$ ' + fmt(fcfe) + ' Mi']
                                    ].map(([label, val], i) => 
                                        h('div', { key: i, className: 'flex justify-between' + (i === 4 ? ' border-t pt-2 mt-2' : '') },
                                            h('span', null, label + ':'),
                                            h('span', { className: 'font-bold' + (i === 4 ? ' text-green-700' : '') }, val)
                                        )
                                    )
                                )
                            )
                        ),

                        h('div', { className: 'mt-4 p-4 bg-yellow-50 border-l-4 border-yellow-400 rounded' },
                            h('h4', { className: 'font-semibold text-yellow-900 mb-2' }, 
                                'âš ï¸ Premissas Importantes'
                            ),
                            h('ul', { className: 'text-sm text-yellow-800 space-y-1' },
                                h('li', null, 'â€¢ Taxas de crescimento devem ser sustentÃ¡veis e compatÃ­veis com histÃ³rico'),
                                h('li', null, 'â€¢ ROIC acima do custo de capital tende a convergir pela competiÃ§Ã£o'),
                                h('li', null, 'â€¢ Perpetuidade representa ' + ((vpPerpetuidade / valorTotalFirma) * 100).toFixed(1) + '% do valor (>80% pode ser otimista)'),
                                h('li', null, 'â€¢ Taxa DI futura deve refletir expectativas macroeconÃ´micas')
                            )
                        )
                    ),

                    // FundamentaÃ§Ã£o
                    h('div', { className: 'bg-white rounded-lg shadow-lg p-6' },
                        h('h3', { className: 'text-lg font-semibold mb-3' }, 
                            'ðŸ“š FundamentaÃ§Ã£o MetodolÃ³gica'
                        ),
                        h('div', { className: 'text-sm text-gray-700 space-y-2' },
                            h('p', null, h('strong', null, 'Modelo DCF:'), ' Valor = Î£ (FCFEt / (1 + WACC)^t) + Valor Perpetuidade'),
                            h('p', null, h('strong', null, 'Perpetuidade (Gordon):'), ' VP = [FCFE Ã— (1 + g)] / (WACC - g) Ã— 1/(1 + WACC)^n'),
                            h('p', null, h('strong', null, 'WACC:'), ' Taxa DI Futura + PrÃªmio de Risco = ' + wacc.toFixed(2) + '%'),
                            h('p', null, h('strong', null, 'ConvergÃªncia ROIC:'), ' ROIC(t+1) = ROIC(t) - 0,2 Ã— (ROIC(t) - Custo Capital)'),
                            h('p', { className: 'text-xs text-gray-500 mt-3 pt-3 border-t' },
                                'ReferÃªncias: Damodaran, Assaf Neto, PÃ³voa | CÃ³digos CVM: 3.05 (EBIT), 3.11 (Lucro LÃ­quido), 6.01-6.03 (DFC)'
                            )
                        )
                    ),

                    // Footer
                    h('div', { className: 'text-center text-gray-500 text-sm mt-8 pb-4' },
                        h('p', null, 'Â© 2025 Calculadora DCF | Desenvolvida com React'),
                        h('p', { className: 'mt-1' }, 'Ferramenta gratuita para anÃ¡lise fundamentalista de aÃ§Ãµes')
                    )
                )
            );
        }

        // Renderizar aplicaÃ§Ã£o
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(ValuationCalculator));
    </script>
</body>
</html>
